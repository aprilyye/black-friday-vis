<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <style>
    body {
      font-family: "Open Sans", sans-serif;
      font-size: 14px;
    }

    h1 {
      font-weight: normal;
      font-size: 20px;
      text-align: center;
      margin-top: 40px
    }

    #authors {
      text-align: center;
      font-size: 14px;
      margin-top: 5px;
    }

    div {
      margin: 30px;
    }

    .description {
      width: 650px;
      margin: auto;
      margin-top: 50px;
      text-align: center;
      border: solid 1px;
      padding: 30px;

    }
  </style>
</head>

<body>
  <h1>Black Friday Consumer Trends </h1>
  <p id="authors">Kenny Zhou (kz68), April Ye (yy459), Kelly Yu (ky356) </p>
  <div class="description">
    The visualization below illustrates the behaviors of consumers on Black Friday
    in a retail store. It compares the consumer trends between different age
    groups and genders by analyzing the amount spent on purchases on this popular
    shopping day in the United States.
  </div>
  <p>
    <svg width="800" height="500" id="vis1">
    </svg>


  <svg width="156px" height="268px" viewBox="0 0 156 268" id="pplgirl">
      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g id="Artboard" transform="translate(-859.000000, -387.000000)">
              <g id="girl" transform="translate(855.000000, 387.000000)">
                  <path d="M23.4085737,57.5528923 C27.4855021,57.5528923 36.0329005,57.364705 42.7104511,49.0840613 C48.1730492,42.3100463 52.0455584,30.9361408 54.0264855,28.8393648 C57.4968188,25.166079 81,34.3379489 81,29.1813797 C81,17.4832267 67.2813195,0.125837351 54.0264855,0.125837351 C40.7716515,0.125837351 28.1392098,8.80580904 28.1392098,20.503962 C28.1392098,24.9201247 31.439328,42.5163424 28.1392098,45.3745369 C21.0384739,51.5244028 15.1575641,57.5528923 23.4085737,57.5528923 Z" id="Oval-2" fill="#D8D8D8"></path>
                  <ellipse id="Oval" fill="#C17474" cx="81" cy="60.5" rx="38" ry="38.5"></ellipse>
                  <path d="M81.1212408,74 C116.483472,132.596679 135.650022,174.392624 138.620892,199.387835 C142.809005,234.624229 21.1872481,233.371049 23.6215894,199.387835 C25.4867643,173.350141 44.6533147,131.554196 81.1212408,74 Z" id="Triangle" fill="#C17474"></path>
                  <rect id="Rectangle-2" fill="#C17474" x="47" y="202" width="28" height="66" rx="14"></rect>
                  <rect id="Rectangle-2" fill="#C17474" x="89" y="202" width="28" height="66" rx="14"></rect>
                  <rect id="Rectangle-3" fill="#C17474" transform="translate(121.000000, 132.500000) rotate(30.000000) translate(-121.000000, -132.500000) " x="78" y="121" width="86" height="23" rx="11.5"></rect>
                  <rect id="Rectangle-3" fill="#C17474" transform="translate(43.000000, 130.500000) rotate(-30.000000) translate(-43.000000, -130.500000) " x="0" y="119" width="86" height="23" rx="11.5"></rect>
              </g>
          </g>
      </g>
  </svg>

  <svg width="157px" height="246px" viewBox="0 0 157 246" id="pplboy">
      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g id="Artboard" transform="translate(-189.000000, -73.000000)" fill="#C17474">
              <rect id="Rectangle" x="222" y="149" width="86" height="126"></rect>
              <ellipse id="Oval" cx="265" cy="111.5" rx="38" ry="38.5"></ellipse>
              <rect id="Rectangle-2" x="230" y="253" width="28" height="66" rx="14"></rect>
              <rect id="Rectangle-2" x="272" y="253" width="28" height="66" rx="14"></rect>
              <rect id="Rectangle-3" transform="translate(306.340014, 180.513331) rotate(30.000000) translate(-306.340014, -180.513331) " x="263.340014" y="169.013331" width="86" height="23" rx="11.5"></rect>
              <rect id="Rectangle-3" transform="translate(227.989092, 178.513331) rotate(-30.000000) translate(-227.989092, -178.513331) " x="184.989092" y="167.013331" width="86" height="23" rx="11.5"></rect>
          </g>
      </g>
  </svg>

  <svg width="156px" height="258px" viewBox="0 0 156 258" id="pplboy2">
      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g id="Artboard" transform="translate(-189.000000, -386.000000)">
              <g id="boy" transform="translate(185.000000, 398.000000)" fill="#C17474">
                  <rect id="Rectangle" x="37" y="76" width="86" height="126" rx="20"></rect>
                  <ellipse id="Oval" cx="80" cy="38.5" rx="38" ry="38.5"></ellipse>
                  <rect id="Rectangle-2" x="45" y="180" width="28" height="66" rx="14"></rect>
                  <rect id="Rectangle-2" x="87" y="180" width="28" height="66" rx="14"></rect>
                  <rect id="Rectangle-3" transform="translate(121.000000, 107.500000) rotate(30.000000) translate(-121.000000, -107.500000) " x="78" y="96" width="86" height="23" rx="11.5"></rect>
                  <rect id="Rectangle-3" transform="translate(43.000000, 105.500000) rotate(-30.000000) translate(-43.000000, -105.500000) " x="0" y="94" width="86" height="23" rx="11.5"></rect>
              </g>
              <path d="M261.935243,386.335688 C271.393381,387.621459 277.081634,389.303261 279,391.381094 C280.269172,392.755768 283.584756,397.380817 281.49979,402.369565 C280.788803,404.070761 278.042369,406.614239 273.26049,410 C263.659038,412.957294 256.099331,414.43594 250.58137,414.43594 C245.06341,414.43594 236.202953,412.957294 224,410 C233.220013,404.476628 239.786415,399.910949 243.699204,396.302961 C247.611994,392.694973 253.690673,389.372549 261.935243,386.335688 Z" id="Triangle-2" fill="#D8D8D8"></path>
          </g>
      </g>
  </svg>

  </p>
  <script>
    var blackFridayData1;
    var blackFridayData2
    d3.csv("BlackFriday.csv").then(function (data1) {
      d3.csv("blackfriday2.csv").then(function (data2) {
        blackFridayData1 = data1;
        blackFridayData2 = data2;
        console.log("data =", blackFridayData1); // confirm data is successfully loaded
        console.log("data2=", blackFridayData2);
        var females = males = 0;
        // females age group counters initialized
        var f0to17 = f18to25 = f26to35 = f36to45 = f46to50 = f51to55 = f55andup = 0;
        var f0to17Purchase = f18to25Purchase = f26to35Purchase = f36to45Purchase
          = f46to50Purchase = f51to55Purchase = f55andupPurchase = 0;
        // male age group counters initialized
        var m0to17 = m18to25 = m26to35 = m36to45 = m46to50 = m51to55 = m55andup = 0;
        var m0to17Purchase = m18to25Purchase = m26to35Purchase = m36to45Purchase
          = m46to50Purchase = m51to55Purchase = m55andupPurchase = 0;
        blackFridayData1.forEach(d => {
          if (d['Gender'] == "F") {
            females++;
            if (d['Age'] == "0-17") {
              f0to17++;
              f0to17Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "18-25") {
              f18to25++;
              f18to25Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "26-35") {
              f26to35++;
              f26to35Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "36-45") {
              f36to45++;
              f36to45Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "46-50") {
              f46to50++;
              f46to50Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "51-55") {
              f51to55++;
              f51to55Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "55+") {
              f55andup++;
              f55andupPurchase += parseInt(d['Purchase']);
            }
          } else if (d['Gender'] == "M") {
            males++;
            if (d['Age'] == "0-17") {
              m0to17++;
              m0to17Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "18-25") {
              m18to25++;
              m18to25Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "26-35") {
              m26to35++;
              m26to35Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "36-45") {
              m36to45++;
              m36to45Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "46-50") {
              m46to50++;
              m46to50Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "51-55") {
              m51to55++;
              m51to55Purchase += parseInt(d['Purchase']);
            } else if (d['Age'] == "55+") {
              m55andup++;
              m55andupPurchase += parseInt(d['Purchase']);
            }
          }

        });

        // calculating percentages
        var f0to17Percent = (f0to17 / females).toFixed(2);
        var f18to25Percent = (f18to25 / females).toFixed(2);
        var f26to35Percent = (f26to35 / females).toFixed(2);
        var f36to45Percent = (f36to45 / females).toFixed(2);
        var f46to50Percent = (f46to50 / females).toFixed(2);
        var f51to55Percent = (f51to55 / females).toFixed(2);
        var f55andupPercent = (f55andup / females).toFixed(2);

        var m0to17Percent = (m0to17 / males).toFixed(2);
        var m18to25Percent = (m18to25 / males).toFixed(2);
        var m26to35Percent = (m26to35 / males).toFixed(2);
        var m36to45Percent = (m36to45 / males).toFixed(2);
        var m46to50Percent = (m46to50 / males).toFixed(2);
        var m51to55Percent = (m51to55 / males).toFixed(2);
        var m55andupPercent = (m55andup / males).toFixed(2);


        // outputting results
        console.log("females =", females);
        console.log("females17 =", f0to17, f0to17Percent, f0to17Purchase);
        console.log("females18 =", f18to25, f18to25Percent, f18to25Purchase);
        console.log("females26 =", f26to35, f26to35Percent, f26to35Purchase);
        console.log("females36 =", f36to45, f36to45Percent, f36to45Purchase);
        console.log("females46 =", f46to50, f46to50Percent, f46to50Purchase);
        console.log("females51 =", f51to55, f51to55Percent, f51to55Purchase);
        console.log("females55 =", f55andup, f55andupPercent, f55andupPurchase);

        console.log("males =", males);
        console.log("males17 =", m0to17, m0to17Percent, m0to17Purchase);
        console.log("males18 =", m18to25, m18to25Percent, m18to25Purchase);
        console.log("males26 =", m26to35, m26to35Percent, m26to35Purchase);
        console.log("males36 =", m36to45, m36to45Percent, m36to45Purchase);
        console.log("males46 =", m46to50, m46to50Percent, m46to50Purchase);
        console.log("males51 =", m51to55, m51to55Percent, m51to55Purchase);
        console.log("males55 =", m55andup, m55andupPercent, m55andupPurchase);

        // Building the grouped bar graph
        // svg backbone
        let svg = d3.select("svg#vis1");
        let width = svg.attr("width");
        let height = svg.attr("height");
        let margin = { top: 50, right: 50, bottom: 50, left: 50 };
        let chartWidth = width - margin.left - margin.right;
        let chartHeight = height - margin.top - margin.bottom;

        let svgGirl = d3.select("#pplgirl");
        var g2 = svgGirl.append("g")
          .attr("transform", "translate(50, 10)");

        let svgBoy = d3.select("#pplboy");
        var g3 = svgBoy.append("g")
          .attr("transform", "translate(150, 10)");

        let svgBoy2 = d3.select("#pplboy2");
        var g4 = svgBoy2.append("g")
          .attr("transform", "translate(250, 10)");



        // // Scales
        // let ageGroupScale = d3.scalePoint()
        //   .domain(["0-17", "18-25", "26-35", "36-45", "46-50", "51-55", "55+"])
        //   .range([20, chartWidth]);
        // let maxPurchase = d3.max([f0to17Purchase, f18to25Purchase, f26to35Purchase,
        //   f36to45Purchase, f46to50Purchase, f51to55Purchase, f55andupPurchase,
        //   m0to17Purchase, m18to25Purchase, m26to35Purchase, m36to45Purchase,
        //   m46to50Purchase, m51to55Purchase, m55andupPurchase]);
        // let purchasesScale = d3.scaleLinear()
        //   .domain([0, maxPurchase])
        //   .range([chartHeight, 0]);

        // // X and Y axes
        // let xAxis = d3.axisBottom()
        //   .scale(ageGroupScale);
        // let yAxis = d3.axisLeft()
        //   .ticks(10, d3.format("$"))
        //   .scale(purchasesScale);
        // svg.append("g")
        //   .attr("transform", "translate(" + margin.left + "," + (margin.top + chartHeight) + ")")
        //   .call(xAxis)
        //   .style("font-size", "8");
        // svg.append("g")
        //   .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
        //   .call(yAxis)
        //   .style("font-size", "8");

      })
    })
      .catch((err) => {
        throw new Error("Something went wrong", err);
      });
  </script>
</body>

</html>
